<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢ - Meeting</title>
  <!-- ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° Google Fonts ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Prompt -->
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;500;600&display=swap" rel="stylesheet">
  <!-- ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° SweetAlert2 -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    /* Styling */
    body {
      font-family: 'Prompt', sans-serif; /* ‡πÉ‡∏ä‡πâ‡∏ü‡∏≠‡∏ô‡∏ï‡πå Prompt */
      background-color: #f4f7fa;
      padding: 20px;
      font-size: 16px; /* ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô */
    }

    h2 {
      color: #333;
      text-align: center;
      margin-bottom: 20px;
      font-size: 30px; /* ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á */
      font-weight: 600;
    }

    form {
      background-color: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
      max-width: 600px;
      margin: 0 auto;
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      font-weight: 500;
      margin-bottom: 10px;
      font-size: 16px; /* ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏Ç‡∏≠‡∏á label */
    }

    input, select, button {
      width: 100%;
      padding: 15px;
      margin: 5px 0 15px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 16px; /* ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• */
    }

    button {
      background-color: #3498db; /* ‡∏™‡∏µ‡∏ü‡πâ‡∏≤ */
      color: white;
      font-size: 18px;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    button:disabled {
      background-color: #ccc;
    }

    button:hover {
      background-color: #2980b9; /* ‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏° */
    }
  </style>
</head>
<body>

<h2>‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢ - Meeting</h2>

<form id="appointment-form">
  <div class="form-group">
    <label for="name">‡∏ä‡∏∑‡πà‡∏≠</label>
    <input type="text" id="name" name="name" required>
  </div>

  <div class="form-group">
    <label for="preferred_date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∞‡∏î‡∏ß‡∏Å</label>
    <input type="date" id="preferred_date" name="preferred_date" required>
  </div>

  <div class="form-group">
    <label for="time">‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</label>
    <select id="time" name="time" required>
      <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤</option>
      <option value="‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á">‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á</option>
      <option value="18:00">18:00</option>
      <option value="19:00">19:00</option>
      <option value="19:30">19:30</option>
      <option value="20:00">20:00</option>
    </select>
  </div>

  <div class="form-group" id="meeting-method-group">
    <label for="meeting_method">‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á Meeting</label>
    <select id="meeting_method" name="meeting_method" required>
      <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á</option>
      <option value="Google Meet">Google Meet</option>
      <option value="Line Meeting">Line Meeting</option>
      <option value="Clubhouse">Clubhouse</option>
      <option value="Discord">Discord</option>
    </select>
  </div>

  <div class="form-group" id="discord-message" class="discord-message" style="display: none;">
    <p>‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Discord ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>
  </div>

  <button type="submit" id="submit-btn">‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°</button>
</form>

<script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycby3I8lNWNQiA8zzCGQ4Eg1uXvJFsW7H-gU0UzwVps0X6E8WqdjcWMmDo-61tFHR3k5WtQ/exec';  // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
  const submitBtn = document.getElementById('submit-btn');
  const meetingMethodSelect = document.getElementById('meeting_method');
  const discordMessage = document.getElementById('discord-message');
  const timeSelect = document.getElementById('time');
  
  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
  document.getElementById('appointment-form').addEventListener('submit', function(e) {
    e.preventDefault(); // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£ submit ‡πÅ‡∏ö‡∏ö‡∏õ‡∏Å‡∏ï‡∏¥

    submitBtn.disabled = true;
    submitBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á...';

    // ‡πÅ‡∏™‡∏î‡∏á SweetAlert ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á"
    Swal.fire({
      title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...',
      allowOutsideClick: false,
      showConfirmButton: false,
      didOpen: () => {
        Swal.showLoading();
      }
    });

    const formData = new FormData(document.getElementById('appointment-form'));

    fetch(scriptURL, {
      method: 'POST',
      body: formData  // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö FormData
    })
    .then(response => response.json())
    .then(result => {
      if (result.result === 'success') {
        // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
        Swal.fire({
          icon: 'success',
          title: '‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
          text: '‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏∞ üéâ',
          showConfirmButton: false,
          timer: 2000
        }).then(() => {
          document.getElementById('appointment-form').reset(); // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°
        });
      } else {
        // ‡∏´‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î
        Swal.fire({
          icon: 'error',
          title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î!',
          text: result.message,
          showConfirmButton: true
        });
      }

      submitBtn.disabled = false;
      submitBtn.textContent = '‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°';
    })
    .catch(error => {
      // ‡∏´‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢
      Swal.fire({
        icon: 'error',
        title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î!',
        text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á',
        showConfirmButton: true
      });
      submitBtn.disabled = false;
      submitBtn.textContent = '‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°';
    });
  });

  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤
  timeSelect.addEventListener('change', function() {
    const timeValue = timeSelect.value;
    const meetingOptions = [
      { value: 'Google Meet', label: 'Google Meet' },
      { value: 'Line Meeting', label: 'Line Meeting' },
      { value: 'Clubhouse', label: 'Clubhouse' },
      { value: 'Discord', label: 'Discord' }
    ];

    // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á"
    if (timeValue === '‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á') {
      meetingMethodSelect.innerHTML = '<option value="‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á">‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á</option>';  // ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏Ñ‡πà "‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á"
    } else {
      meetingMethodSelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á</option>';  // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï
      meetingOptions.forEach(option => {
        const optionElement = document.createElement('option');
        optionElement.value = option.value;
        optionElement.textContent = option.label;
        meetingMethodSelect.appendChild(optionElement);  // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
      });
    }
  });

  // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á Meeting Discord
  meetingMethodSelect.addEventListener('change', function() {
    if (meetingMethodSelect.value === 'Discord') {
      discordMessage.style.display = 'block';
    } else {
      discordMessage.style.display = 'none';
    }
  });
</script>

</body>
</html>
